{% extends "layout.html" %}
{% block footer %}Sujet n°{{ topic.Id }} - {% endblock %}
{% block title %}Sujet n°{{ topic.Id }} - {% endblock %}
{% block head %}
	{{ super() }}
	<script>
        $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};

		$(function() {
			getScoreColor($('#score'));

			$('a.ptn-poll').click(function(e) {
				var target = $(e.target);

				if(target.is('#plus-one')) {
					value = 1;
				} else if(target.is('#minus-one')) {
					value = -1;
				} else {
					value = 0;
				}
				$.getJSON($SCRIPT_ROOT + '/_update_topic_score'
					, { value: value, topic_id: $('#topic_id').val() }
				  	, function(data) {
				  		$("#score").text(data.result);
				  		getScoreColor($('#score'));
				});
			});
		});
	</script>
{% endblock %}
{% block content %}
	<h2 class="">{{ topic.Question }}</h2>
	<hr/>
	<div class="text-center">
	    <div class="text-center">
	      <h3 id="score">{{ topic.Score }}</h3>
	    </div>
	    <hr/>
{% if session['logged_in'] %}
	    <div class="text-center">
	    	<a href="#" id="plus-one" class="btn btn-success ptn-poll">+</a>
	    	<a href="#" id="minus-one" class="btn btn-danger ptn-poll">-</span></a>
	    </div>
{% endif %}
	</div>
  	<hr/>
  	<hr/>
  	
{% if session['logged_in'] %}
  	<input id="topic_id" type="hidden" value="{{ topic.Id }}"/>

    <form action="{{ url_for('add_comment', question_id=topic.id) }}" method=post>
        <fieldset id="group1">
          <input type="radio" value="True" name="group1">
          <input type="radio" value="False" name="group1">
        </fieldset>
        <div>Quelle est votre question ?</div>
        <textarea name=answer rows=5 cols=40></textarea>
        <input type=submit value=Envoyer>
    </form>
{% endif %}
{% endblock %}
